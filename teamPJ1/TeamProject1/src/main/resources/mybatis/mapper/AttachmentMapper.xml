<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="pieum.capsule.model.AttachmentMapper">

	<!-- 첨부파일 추가 -->
	<insert id="insertAttachment"
		parameterType="pieum.capsule.model.AttachmentDTO">
		INSERT INTO attachments (fno, bno, file_name, file_path, uploaded_at)
		VALUES (#{fno}, #{bno}, #{fileName}, #{filePath}, NOW())
	</insert>

	<!-- 첨부파일 수정 -->
	<update id="updateAttachment"
		parameterType="pieum.capsule.model.AttachmentDTO">
		UPDATE attachments
		SET file_name = #{fileName}, file_path = #{filePath}
		WHERE fno = #{fno}
	</update>

	<!-- 첨부파일 삭제 -->
	<delete id="deleteAttachment" parameterType="string">
		DELETE FROM attachments WHERE fno = #{fno}
	</delete>

	<!-- 특정 게시글의 모든 첨부파일 삭제 -->
	<delete id="deleteAttachmentsByBno" parameterType="string">
		DELETE FROM attachments WHERE bno = #{bno}
	</delete>

</mapper>
